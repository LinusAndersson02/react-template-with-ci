echo "ğŸ”§ Prettier --write (repo-wide)â€¦"
npm run -s format:fix  # prettier . --write

# If Prettier changed anything, stop and ask for a commit
if ! git diff --quiet; then
  echo "âŒ Pre-push blocked: Prettier formatted files."
  echo "   Run: git add -A && git commit -m \"chore: format\" && git push again."
  git status --porcelain
  exit 1
fi

echo "ğŸ§¹ ESLint --fixâ€¦"
npm run -s lint:fix || true

if ! git diff --quiet; then
  echo "âŒ Pre-push blocked: ESLint fixed files."
  echo "   Run: git add -A && git commit -m \"chore: lint fix\" && git push again."
  git status --porcelain
  exit 1
fi

echo "ğŸ§  Typecheck"
npm run -s typecheck

echo "ğŸ§ª Tests"
npm run -s test --if-present

echo "ğŸ—ï¸ Build"
npm run -s build

echo "âœ… Pre-push OK"